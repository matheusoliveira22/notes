### ALB - Application Load Balancer
- Operates on Layer 7 (HTTP)
- Load balancing to multiple HTTP application across machines (target groups)
- Load balancing to multiple applications on the same machine (containers)
- Support for HTTP/2 and WebSocket
- Supports redirects (from HTTP to HTTPS for example)
- Routing tables to different target groups:
	- Routing based on path in URL (example: baseurl/**users** and baseurl/**posts**)
	- Routing based on hostname in URL (example: baseurl1.com and baseurl2.com)
	- Routing based on Query String, Headers (example: baseurl/users?**id=123&order=false**)
- ALB are a great fit for micro services & container-based applications
- Has a port mapping feature to redirect to a dynamic port in ECS
- **Health checks are done on the target group level**
- The ALB has a fixed hostname (XXX.region.elb.amazonaws.com)
- The application servers don't see the IP of the client directly
	- The true IP of the client is inserted in the header X-Forwarded-For
	- We can also get port (X-Forwarded-Port) and protocol (X-Forwarder-Proto)
-  **Can enable sticky sessions with cookies**
	- Application-based Cookie: Customized (generated by the application itself) or Application (Generated by the ALB with the name AWSALBAPP)
	- Duration-based Cookie: Generated by the LB with name AWSALB for ALB or AWSELB for CLB (Classic Load Balancer)

### NLB - Network Load Balancer
- Operates on Layer 4 (TCP/UDP)
- Handles millions of requests per second and has ultra-low latency
- NLB has one static IP per AZ and support assigning Elastic IP
- Target Groups: Private IP address, EC2 instances and ALBs
- Health checks support: TCP, HTTP and HTTPs
- **Can enable sticky sessions without cookies**

### GLB - Gateway Load Balancer
- Operates on Layer 3 (Network Layer - IP Packets)
- Deploy, manage and scale a fleet of 3rd party network virtual appliances
- Example: Firewalls, Intrusion Detection and Prevention Systems, Deep Packet Inspection Systems
- Combine following functions:
	- Transparent Network Gateway: single entry/exit for all traffic
	- Load Balancer: distribute traffic to your virtual appliances
- Use GENEVE protocol on port 6081
- Target Groups: Private IP address and EC2 instances

### Cross-zone Load Balancing
- With Cross Zone Load Balancing: Each load balancer instance distributes evenly
across all registered instances in all AZ
- Without Cross Zone Load Balancing: Requests are distributed in the instances of the
node of the Elastic Load Balancer

• Application Load Balancer:
	• Enabled by default (can be disabled at the Target Group level)
	• No charges for inter AZ data
• Network Load Balancer & Gateway Load Balancer:
	• Disabled by default
	• You pay charges ($) for inter AZ data if enabled
• Classic Load Balancer:
	• Disabled by default
	• No charges for inter AZ data if enabled

### SSL Certificates
• Classic Load Balancer (v1)
	• Support only one SSL certificate
	• Must use multiple CLB for multiple hostname with multiple SSL certificates
• Application Load Balancer (v2)
	• Supports multiple listeners with multiple SSL certificates
	• Uses Server Name Indication (SNI) to make it work
• Network Load Balancer (v2)
	• Supports multiple listeners with multiple SSL certificates
	• Uses Server Name Indication (SNI) to make it work

### Connection Draining (CLB) / Deregistration Delay (ALB & NLB)
- Time to complete “in-flight requests” while the
instance is de-registering or unhealthy
- Stops sending new requests to the EC2
instance which is de-registering
- Between 1 to 3600 seconds (default: 300
seconds)
- Can be disabled (set value to 0)
- Set to a low value if your requests are short

### Auto Scaling Policies
• Dynamic Scaling
	• Target Tracking Scaling
		• Simple to set-up
		• Example: CPU to stay at around 50%
	• Simple / Step Scaling
		• When a CloudWatch alarm is triggered (example CPU > 70%), then add 2 units
		• When a CloudWatch alarm is triggered (example CPU < 30%), then remove 1
• Scheduled Scaling
	• Anticipate a scaling based on known usage patterns
	• Example: increase the min capacity to 3 at 5 pm on Fridays
• Predictive scaling: continuously forecast load and schedule scaling ahead